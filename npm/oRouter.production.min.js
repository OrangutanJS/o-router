"use strict";function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){_defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,c=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){c=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(c)throw i}}return o}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _classStaticPrivateFieldSpecGet(t,e,r){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"get"),_classApplyDescriptorGet(t,r)}function _classStaticPrivateFieldSpecSet(t,e,r,n){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorSet(t,r,n),n}function _classStaticPrivateMethodGet(t,e,r){return _classCheckPrivateStaticAccess(t,e),r}function _classApplyDescriptorGet(t,e){return e.get?e.get.call(t):e.value}function _classApplyDescriptorSet(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function _classCheckPrivateStaticAccess(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}function _classCheckPrivateStaticFieldDescriptor(t,e){if(void 0===t)throw new TypeError("attempted to "+e+" private static field before its declaration")}function renderIfHtmlElementGiven(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;if(t){var r=function(t){e.innerHTML="",e.appendChild(t)};if(t instanceof HTMLElement&&r(t),t.init&&"function"==typeof t.init){var n=t.init();n instanceof HTMLElement&&r(n)}}}function routesFilter(t,e){for(var r=Object.keys(e).map((function(t){return{full:t,splitted:t.split("/").filter((function(t){return""!==t}))}})).filter((function(e){return e.splitted.length===t.length})),n=function(e){r=r.filter((function(r){return r.splitted[e]===t[e]||r.splitted[e].startsWith(":")}))},i=0;i<t.length;i++)n(i);return r}function setOnPopStateEvent(t){window.onpopstate||(window.onpopstate=function(e){e.preventDefault(),t()})}function decodeSearchQuery(t){var e=Object.create(null);return"string"==typeof t&&t.length&&t.startsWith("?")?(t.substring(1).split("&").forEach((function(t){var r=_slicedToArray(t.split("="),2),n=r[0],i=r[1];e[decodeURIComponent(n)]=decodeURIComponent(i)})),e):e}function createUrlObject(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"object"===_typeof(t)&&t instanceof URL?t:t||""===t?new URL(window.location.origin+e+t):new URL(window.location.href)}function splitAndFilterPath(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.startsWith("/")?e.substring(1):e;return t.split("/").filter((function(t){return""!==t&&t!==r}))}Object.defineProperty(exports,"__esModule",{value:!0});var FORBIDDEN_PARAMETERS=["fullPath","url","hash","searchParameters"];function decodeParameters(t,e){var r={};return t.splitted.forEach((function(t,n){if(t.startsWith(":")){var i=t.replace(":","");if(FORBIDDEN_PARAMETERS.includes(i))return;r[i]=e[n]}})),r}function encodeSearchQuery(t){if(!t||"object"!==_typeof(t))return"";var e="?";return(e+=Object.entries(t).filter((function(t){return searchParametersFilter(t)})).map((function(t){return searchParametersMapper(t)})).join("&")).substring(1).length?e:""}function searchParametersFilter(t){var e=_slicedToArray(t,2)[1];return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function searchParametersMapper(t){var e=_slicedToArray(t,2),r=e[0],n=e[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(n))}var oRouter=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"defaultView",set:function(e){if(!e||"function"!=typeof e)return!1;_classStaticPrivateFieldSpecSet(t,t,_defaultView,e)}},{key:"routingParameters",get:function(){return _classStaticPrivateFieldSpecGet(t,t,_routingParameters)},set:function(t){return t}},{key:"redirect",value:function(e,r){t.route(e,r)}},{key:"route",value:function(e,r){setOnPopStateEvent(t.route);var n=createUrlObject(e,t.originPrefix);_classStaticPrivateFieldSpecSet(t,t,_routingParameters,{fullPath:n.href.replace(n.origin,""),url:n,searchParameters:decodeSearchQuery(n.search),hash:n.hash,parameters:{}}),"object"===_typeof(r)&&Object.assign(_classStaticPrivateFieldSpecGet(t,t,_routingParameters),r);var i=splitAndFilterPath(n.pathname,t.originPrefix);if(!i.length)return _classStaticPrivateMethodGet(t,t,_changeState).call(t,n),renderIfHtmlElementGiven(_classStaticPrivateFieldSpecGet(t,t,_defaultView).call(t,_classStaticPrivateFieldSpecGet(t,t,_routingParameters))),!0;var o=routesFilter(i,t.routingTable);if(!o.length){var a=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url;return!!t.routingTable["404-notFound"]&&(_classStaticPrivateMethodGet(t,t,_changeState).call(t,a),renderIfHtmlElementGiven(t.routingTable["404-notFound"](_classStaticPrivateFieldSpecGet(t,t,_routingParameters))),!1)}var c=o[0];return Object.assign(_classStaticPrivateFieldSpecGet(t,t,_routingParameters).parameters,decodeParameters(c,i)),_classStaticPrivateMethodGet(t,t,_changeState).call(t,n),renderIfHtmlElementGiven(t.routingTable[c.full](_classStaticPrivateFieldSpecGet(t,t,_routingParameters))),!0}},{key:"setSearchParameter",value:function(e,r){return!(!e||"string"!=typeof e||"object"===_typeof(r))&&t.setSearchParameters(_defineProperty({},e,String(r)))}},{key:"unsetSearchParameter",value:function(e){if(!_classStaticPrivateFieldSpecGet(t,t,_routingParameters).searchParameters[e])return!1;delete _classStaticPrivateFieldSpecGet(t,t,_routingParameters).searchParameters[e];var r=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url,n=_classStaticPrivateMethodGet(t,t,_searchParametersToString).call(t);return r.search="?".concat(n),_classStaticPrivateMethodGet(t,t,_changeState).call(t,r)}},{key:"setSearchParameters",value:function(e){if("object"!==_typeof(e))return!1;if(!Object.keys(e).length)return!0;var r=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url;return r.search=_classStaticPrivateMethodGet(t,t,_searchParametersToString).call(t,e),_classStaticPrivateMethodGet(t,t,_changeState).call(t,r)}},{key:"unsetSearchParametersAll",value:function(){var e=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url,r=decodeSearchQuery(e.search);return Object.keys(r).forEach((function(e){return t.unsetSearchParameter(e)})),_classStaticPrivateMethodGet(t,t,_changeState).call(t,e)}},{key:"setHash",value:function(e){if(!e||"object"===_typeof(e))return!1;e=String(e);var r=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url;return e.startsWith("#")&&(e=e.substring(1)),!!new RegExp("#?".concat(e,"(#|$)"),"i").test(r.hash)||(r.hash+="#"+e,_classStaticPrivateMethodGet(t,t,_changeState).call(t,r))}},{key:"unsetHash",value:function(e){if(!e||"object"===_typeof(e))return!1;e=String(e);var r=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url;e.startsWith("#")&&(e=e.substring(1));var n=new RegExp("#?".concat(e,"(#|$)"),"i");return r.hash=r.hash.replace(n,""),_classStaticPrivateMethodGet(t,t,_changeState).call(t,r)}},{key:"unsetHashAll",value:function(){_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url.hash.split("#").filter((function(t){return""!==t})).forEach((function(e){return t.unsetHash(e)}))}},{key:"isSetHash",value:function(e){var r=new RegExp("#?".concat(e,"(#|$)")),n=_classStaticPrivateFieldSpecGet(t,t,_routingParameters).url;return r.test(n.hash)}},{key:"back",value:function(){window.history.back()}}]),t}();function _searchParametersToString(t){return t&&Object.assign(_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters).searchParameters,t),encodeSearchQuery(_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters).searchParameters)}function _changeState(t){var e=t.pathname;_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters).fullPath=t.href.replace(t.origin,"");try{if(e===window.location.pathname)window.history.replaceState(JSON.parse(JSON.stringify(_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters))),document.title,t);else{var r=_objectSpread2(_objectSpread2({},_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters)),{},{redirectedFrom:window.location.pathname});window.history.pushState(JSON.parse(JSON.stringify(r)),document.title,t)}return!0}catch(t){return console.warn(t),!1}}_defineProperty(oRouter,"originPrefix",""),_defineProperty(oRouter,"routingTable",{});var _routingParameters={writable:!0,value:{}},_defaultView={writable:!0,value:function(){return null}};function oFragment(...t){if(!(this instanceof oFragment))return new oFragment(...t);this.children=1===t.length&&Array.isArray(t[0])?t[0]:t,this._isofragment=!0}function addMethodService(t){if(this._isoelement){if("boolean"!=typeof t&&null!=t)if(Array.isArray(t))t.forEach((t=>addMethodService.call(this,t)));else if(t._isofragment)t.init().forEach((t=>addMethodService.call(this,t)));else if(t instanceof HTMLElement)this.element.appendChild(t);else if(t._isoelement||t.__proto__.init){const e=t.init();e instanceof HTMLElement&&this.element.appendChild(e)}}else console.error("Wrong usage of addService function")}function inputFunction(t,e,r){return"INPUT"!==t.element.nodeName||void 0===r||(t.element[e]=r),t}function o(t){if(!(this instanceof o))return new o(t);"fragment"!==t?t instanceof HTMLElement?this.element=t:(this.element=document.createElement(t),this._isoelement=!0):this.element=oFragment()}function oLink(t){if(!(this instanceof oLink))return new oLink(t);this.element=o("a").click((function(e){e.preventDefault(),e.stopPropagation(),t&&oRouter.redirect(t)}))}oFragment.prototype.add=function(...t){if(!t.length)return this;const e=1===t.length&&Array.isArray(t[0])?t[0]:t;return this.children=this.children.concat(e),this},oFragment.prototype.init=function(){return this.children},o.prototype.event=function(t){return t instanceof Array?t.forEach((t=>this.element.addEventListener(t.name,t.fn))):t instanceof Object&&this.element.addEventListener(t.name,t.fn),this},o.prototype.click=function(t){return this.element.addEventListener("click",t),this},o.prototype.setAttribute=function(t,e){return this.element.setAttribute(t,e),this},o.prototype.setAttributes=function(t){return this.attr(t)},o.prototype.attr=function(t){return Array.isArray(t)?t.forEach((t=>this.element.setAttribute(t.name,t.val))):Object.entries(t).forEach((([t,e])=>this.element.setAttribute(t,e))),this},o.prototype.class=function(t){return Array.isArray(t)?t.forEach((t=>this.element.classList.add(t))):"string"==typeof t&&(this.element.className=t),this},o.prototype.classList=function(t){return this.class(t)},o.prototype.className=function(t){return this.class(t)},o.prototype.id=function(t){return this.element.setAttribute("id",t),this},o.prototype.add=function(...t){return t.forEach((t=>addMethodService.call(this,t))),this},o.prototype.for=function(t){return"LABEL"===this.element.nodeName&&this.element.setAttribute("for",t),this},o.prototype.get=function(t){return this.element[t]||void 0},o.prototype.getText=function(){return this.element.innerText},o.prototype.getId=function(){return this.element.id||void 0},o.prototype.parent=function(){const{parentNode:t}=this.element;return t?o(t):null},o.prototype.text=function(t){return["undefined","object","function"].includes(typeof t)||(this.element.textContent=t),this},o.prototype.html=function(t){if("object"==typeof t)try{this.element.appendChild(t)}catch(e){console.warn("Object is not HTMLElement: parametr 1 is type "+typeof t+"\n"+e)}else void 0!==typeof t&&void 0!==t&&(this.element.innerHTML=t);return this},o.prototype.init=function(){return this.element instanceof oFragment?this.element.init():this.element},o.prototype.ref=function(t){return t&&t._isoref?(t.target=this.element,t.o=this,this):this},o.prototype.style=function(t){return this.element.setAttribute("style",t),this},o.prototype.placeholder=function(t){return inputFunction(this,"placeholder",t)},o.prototype.value=function(t){return inputFunction(this,"value",t)},o.prototype.type=function(t){return inputFunction(this,"type",t)},o.prototype.name=function(t){return inputFunction(this,"name",t)},o.prototype.min=function(t){return inputFunction(this,"min",t)},o.prototype.max=function(t){return inputFunction(this,"max",t)},o.prototype.disabled=function(t){return inputFunction(this,"disabled",t)},o.prototype.required=function(t){return inputFunction(this,"required",t)},oLink.prototype.add=function(){var t;return(t=this.element).add.apply(t,arguments),this},oLink.prototype.setAttribute=function(t,e){return this.element.setAttribute(t,e),this},oLink.prototype.setAttributes=function(t){return this.element.attr(t),this},oLink.prototype.attr=o.prototype.setAttributes,oLink.prototype.class=function(t){return this.element.class(t),this},oLink.prototype.classList=function(t){return this.class(t)},oLink.prototype.className=function(t){return this.class(t)},oLink.prototype.id=function(t){return this.element.id(t),this},oLink.prototype.get=function(t){return this.element.get(t)},oLink.prototype.getText=function(){return this.element.getText()},oLink.prototype.getId=function(){return this.element.getId()},oLink.prototype.parent=function(){return this.element.parent()},oLink.prototype.text=function(t){return this.element.text(t),this},oLink.prototype.to=function(t){return this.element.click((function(){oRouter.redirect(t)})),this},oLink.prototype.init=function(){return this.element.init()},oLink.prototype.ref=function(t){return this.element.ref(t),this},oLink.prototype.style=function(t){return this.element.style(t),this},exports.default=oRouter,exports.oLink=oLink;