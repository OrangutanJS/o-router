"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i=[],c=!0,o=!1;try{for(r=r.call(e);!(c=(a=r.next()).done)&&(i.push(a.value),!t||i.length!==t);c=!0);}catch(e){o=!0,n=e}finally{try{c||null==r.return||r.return()}finally{if(o)throw n}}return i}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _classStaticPrivateFieldSpecGet(e,t,r){return _classCheckPrivateStaticAccess(e,t),_classCheckPrivateStaticFieldDescriptor(r,"get"),_classApplyDescriptorGet(e,r)}function _classStaticPrivateFieldSpecSet(e,t,r,a){return _classCheckPrivateStaticAccess(e,t),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorSet(e,r,a),a}function _classStaticPrivateMethodGet(e,t,r){return _classCheckPrivateStaticAccess(e,t),r}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}function _classApplyDescriptorSet(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _classCheckPrivateStaticAccess(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}function _classCheckPrivateStaticFieldDescriptor(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function renderIfHtmlElementGiven(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;if(e){var r=function(e){t.innerHTML="",t.appendChild(e)};if(e instanceof HTMLElement&&r(e),e.init&&"function"==typeof e.init){var a=e.init();a instanceof HTMLElement&&r(a)}}}function routesFilter(e,t){for(var r=Object.keys(t).map((function(e){return{full:e,splitted:e.split("/").filter((function(e){return""!==e}))}})).filter((function(t){return t.splitted.length===e.length})),a=function(t){r=r.filter((function(r){return r.splitted[t]===e[t]||r.splitted[t].startsWith(":")}))},n=0;n<e.length;n++)a(n);return r}function setOnPopStateEvent(e){window.onpopstate||(window.onpopstate=function(t){t.preventDefault(),e()})}function decodeSearchQuery(e){var t=Object.create(null);return"string"==typeof e&&e.length&&e.startsWith("?")?(e.substring(1).split("&").forEach((function(e){var r=_slicedToArray(e.split("="),2),a=r[0],n=r[1];t[decodeURIComponent(a)]=decodeURIComponent(n)})),t):t}function createUrlObject(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"object"===_typeof(e)&&e instanceof URL?e:e||""===e?new URL(window.location.origin+t+e):new URL(window.location.href)}function splitAndFilterPath(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.startsWith("/")?t.substring(1):t;return e.split("/").filter((function(e){return""!==e&&e!==r}))}var FORBIDDEN_PARAMETERS=["fullPath","url","hash","searchParameters"];function decodeParameters(e,t){var r={};return e.splitted.forEach((function(e,a){if(e.startsWith(":")){var n=e.replace(":","");if(FORBIDDEN_PARAMETERS.includes(n))return;r[n]=t[a]}})),r}function encodeSearchQuery(e){if(!e||"object"!==_typeof(e))return"";var t="?";return(t+=Object.entries(e).filter((function(e){return searchParametersFilter(e)})).map((function(e){return searchParametersMapper(e)})).join("&")).substring(1).length?t:""}function searchParametersFilter(e){var t=_slicedToArray(e,2)[1];return"string"==typeof t||"number"==typeof t||"boolean"==typeof t}function searchParametersMapper(e){var t=_slicedToArray(e,2),r=t[0],a=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(a))}var oRouter=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"defaultView",set:function(t){if(!t||"function"!=typeof t)throw new Error("Not valid defaultView parametereter.");_classStaticPrivateFieldSpecSet(e,e,_defaultView,t)}},{key:"routingParameters",get:function(){return _classStaticPrivateFieldSpecGet(e,e,_routingParameters)},set:function(e){return e}},{key:"redirect",value:function(t,r){e.route(t,r)}},{key:"route",value:function(t,r){setOnPopStateEvent(e.route);var a=createUrlObject(t,e.originPrefix);_classStaticPrivateFieldSpecSet(e,e,_routingParameters,{fullPath:a.href.replace(a.origin,""),url:a,searchParameters:decodeSearchQuery(a.search),hash:a.hash,parameters:{}}),"object"===_typeof(r)&&Object.assign(_classStaticPrivateFieldSpecGet(e,e,_routingParameters),r);var n=splitAndFilterPath(a.pathname,e.originPrefix);if(!n.length)return _classStaticPrivateMethodGet(e,e,_changeState).call(e,a),renderIfHtmlElementGiven(_classStaticPrivateFieldSpecGet(e,e,_defaultView).call(e,_classStaticPrivateFieldSpecGet(e,e,_routingParameters))),!0;var i=routesFilter(n,e.routingTable);if(!i.length){var c=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url;return!!e.routingTable["404-notFound"]&&(_classStaticPrivateMethodGet(e,e,_changeState).call(e,c),renderIfHtmlElementGiven(e.routingTable["404-notFound"](_classStaticPrivateFieldSpecGet(e,e,_routingParameters))),!1)}var o=i[0];return Object.assign(_classStaticPrivateFieldSpecGet(e,e,_routingParameters).parameters,decodeParameters(o,n)),_classStaticPrivateMethodGet(e,e,_changeState).call(e,a),renderIfHtmlElementGiven(e.routingTable[o.full](_classStaticPrivateFieldSpecGet(e,e,_routingParameters))),!0}},{key:"setSearchParameter",value:function(t,r){return!(!t||"string"!=typeof t||"object"===_typeof(r))&&e.setSearchParameters(_defineProperty({},t,String(r)))}},{key:"unsetSearchParameter",value:function(t){if(!_classStaticPrivateFieldSpecGet(e,e,_routingParameters).searchParameters[t])return!1;delete _classStaticPrivateFieldSpecGet(e,e,_routingParameters).searchParameters[t];var r=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url,a=_classStaticPrivateMethodGet(e,e,_searchParametersToString).call(e);return r.search="?".concat(a),_classStaticPrivateMethodGet(e,e,_changeState).call(e,r)}},{key:"setSearchParameters",value:function(t){if("object"!==_typeof(t))return!1;if(!Object.keys(t).length)return!0;var r=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url;return r.search=_classStaticPrivateMethodGet(e,e,_searchParametersToString).call(e,t),_classStaticPrivateMethodGet(e,e,_changeState).call(e,r)}},{key:"unsetSearchParametersAll",value:function(){var t=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url,r=decodeSearchQuery(t.search);return Object.keys(r).forEach((function(t){return e.unsetSearchParameter(t)})),_classStaticPrivateMethodGet(e,e,_changeState).call(e,t)}},{key:"setHash",value:function(t){if(!t||"object"===_typeof(t))return!1;t=String(t);var r=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url;return t.startsWith("#")&&(t=t.substring(1)),!!new RegExp("#?".concat(t,"(#|$)"),"i").test(r.hash)||(r.hash+="#"+t,_classStaticPrivateMethodGet(e,e,_changeState).call(e,r))}},{key:"unsetHash",value:function(t){if(!t||"object"===_typeof(t))return!1;t=String(t);var r=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url;t.startsWith("#")&&(t=t.substring(1));var a=new RegExp("#?".concat(t,"(#|$)"),"i");return r.hash=r.hash.replace(a,""),_classStaticPrivateMethodGet(e,e,_changeState).call(e,r)}},{key:"unsetHashAll",value:function(){_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url.hash.split("#").filter((function(e){return""!==e})).forEach((function(t){return e.unsetHash(t)}))}},{key:"isSetHash",value:function(t){var r=new RegExp("#?".concat(t,"(#|$)")),a=_classStaticPrivateFieldSpecGet(e,e,_routingParameters).url;return r.test(a.hash)}},{key:"back",value:function(){window.history.back()}}]),e}();function _searchParametersToString(e){return e&&Object.assign(_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters).searchParameters,e),encodeSearchQuery(_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters).searchParameters)}function _changeState(e){var t=e.pathname;_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters).fullPath=e.href.replace(e.origin,"");try{if(t===window.location.pathname)window.history.replaceState(JSON.parse(JSON.stringify(_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters))),document.title,e);else{var r=_objectSpread2(_objectSpread2({},_classStaticPrivateFieldSpecGet(oRouter,oRouter,_routingParameters)),{},{redirectedFrom:window.location.pathname});window.history.pushState(JSON.parse(JSON.stringify(r)),document.title,e)}return!0}catch(e){return console.warn(e),!1}}_defineProperty(oRouter,"originPrefix",""),_defineProperty(oRouter,"routingTable",{});var _routingParameters={writable:!0,value:{}},_defaultView={writable:!0,value:function(){return null}};module.exports=oRouter;